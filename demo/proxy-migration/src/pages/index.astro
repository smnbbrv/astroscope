---
import '../styles/index.css';
import Layout from '../../../shared/Layout.astro';
---

<Layout title="Strangler Fig Migration" package="@astroscope/proxy">
  <p class="text-lg mb-6">This demo shows the strangler fig pattern for gradually migrating a legacy website to Astro.</p>

  <div class="flex gap-2 mb-6">
    <a href="/" class="btn btn-primary btn-sm">Home</a>
    <a href="/about" class="btn btn-primary btn-sm">About</a>
    <a href="/contact" class="btn btn-ghost btn-sm">Contact (legacy)</a>
    <a href="/products" class="btn btn-ghost btn-sm">Products (legacy)</a>
  </div>

  <div class="card bg-base-100 shadow-xl mb-6">
    <div class="card-body">
      <h2 class="card-title">
        <span class="badge badge-success">Astro</span> This page has been migrated
      </h2>
      <p>New pages built in Astro automatically take precedence over the catch-all proxy route.</p>
    </div>
  </div>

  <div class="card bg-base-100 shadow-xl mb-6">
    <div class="card-body">
      <h2 class="card-title">Route Mapping</h2>
      <div class="overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th>Path</th>
              <th>Status</th>
              <th>Handled by</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>/</code></td>
              <td><span class="badge badge-success">migrated</span></td>
              <td>Astro</td>
            </tr>
            <tr>
              <td><code>/about</code></td>
              <td><span class="badge badge-success">migrated</span></td>
              <td>Astro</td>
            </tr>
            <tr>
              <td><code>/contact</code></td>
              <td><span class="badge badge-ghost">legacy</span></td>
              <td>Proxied to httpbin.org</td>
            </tr>
            <tr>
              <td><code>/products</code></td>
              <td><span class="badge badge-ghost">legacy</span></td>
              <td>Proxied to httpbin.org</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="card bg-base-100 shadow-xl">
    <div class="card-body">
      <h2 class="card-title">Debug</h2>
      <p class="mb-2">
        Test: <a href="/headers" class="link link-primary" target="_blank">Headers endpoint</a> (should show request headers
        from httpbin.org)
      </p>
    </div>
  </div>
</Layout>
